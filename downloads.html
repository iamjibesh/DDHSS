<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-TWMKWTSFD6"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-TWMKWTSFD6");
    </script>

    <!-- Metadata -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Bootstrap link -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <!-- Bootstrap icon link -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,200;0,400;0,600;0,800;1,200;1,400;1,600;1,800&display=swap"
      rel="stylesheet"
    />

    <!-- Local css -->
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="faculty.css" />

    <!-- Favicon -->
    <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon" />
    <title>Downloads - DDHSS</title>
  </head>
  <body>
    <!-- Navbar -->
    <nav
      class="navbar fixed-top navbar-expand-lg bg-body-tertiary position-sticky"
    >
      <div class="container-fluid">
        <div class="logo-section">
          <a href="index.html">
            <img
              class="logo"
              src="images/logo.png"
              alt="logo of Dhepdhepi HS School"
            />
          </a>
          <a class="navbar-brand" href="index.html">DDHSS</a>
        </div>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0 w-100 text-center">
            <li class="nav-item ms-lg-auto">
              <a class="nav-link" aria-current="page" href="index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="gallery.html">Gallery</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="faculty.html">Faculty</a>
            </li>
            <!-- Dropdown -->
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                More
              </a>
              <div
                class="dropdown-menu text-center"
                aria-labelledby="navbarDropdown"
              >
                <a class="dropdown-item" href="notifications.html"
                  >Notifications</a
                >
                <a class="dropdown-item active" href="downloads.html"
                  >Downloads</a
                >
                <a class="dropdown-item" href="calender.html"
                  >Holiday Calendar</a
                >
              </div>
            </li>
            <!-- Dropdown Ends -->

            <li class="nav-item">
              <a class="nav-link" href="index.html#contact-us">Contact Us</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Header Section -->
    <div
      class="gallery-header mb-0"
      style="
        background-color: rgb(0, 84, 180);
        background: linear-gradient(
          159deg,
          rgba(0, 84, 180, 1) 0%,
          rgba(64, 224, 208, 1) 100%
        );
      "
    >
      <h2 style="font-size: 40px">Downloads</h2>
    </div>

    <!-- Downloads Section -->
      <!-- Google Sheet Integration -->
      <div class="container my-5">
        <div class="accordion" id="downloadsAccordion">
          <div class="text-center">Loading downloads...</div>
        </div>
      </div>

      <script>
        // PASTE YOUR DOWNLOADS SHEET TSV LINK HERE
        const downloadSheetUrl =
          "https://docs.google.com/spreadsheets/d/e/2PACX-1vQcmvit7eH35bTuyXexoM6EcTem-yTCc-vx6AmqTgXBYRfNF8nO0390wRzW40Dz7a4NYnDmYbzyt7lo/pub?output=tsv";

        async function fetchDownloads() {
          try {
            const response = await fetch(
              downloadSheetUrl + "&t=" + new Date().getTime()
            );
            const data = await response.text();

            const rows = data.split("\n").slice(1);
            const groupedData = {};

            // Step 1: Group data
            rows.forEach((row) => {
              const cols = row.split("\t");
              if (cols.length >= 3) {
                const category = cols[0].trim();
                const title = cols[1].trim();
                const link = cols[2].trim();

                if (category && title && link) {
                  if (!groupedData[category]) {
                    groupedData[category] = [];
                  }
                  groupedData[category].push({ title, link });
                }
              }
            });

            // Step 2: Build HTML
            const accordionContainer =
              document.getElementById("downloadsAccordion");
            accordionContainer.innerHTML = "";

            let index = 0;

            for (const [category, items] of Object.entries(groupedData)) {
              const headingId = `heading${index}`;
              const collapseId = `collapse${index}`;

              // Logic: Open the first item (Index 0) automatically
              const isFirstItem = index === 0;
              const buttonClass = isFirstItem
                ? "accordion-button"
                : "accordion-button collapsed";
              const ariaExpanded = isFirstItem ? "true" : "false";
              const bodyClass = isFirstItem
                ? "accordion-collapse collapse show"
                : "accordion-collapse collapse";

              let headerHTML = `
                    <h2 class="accordion-header" id="${headingId}">
                        <button class="${buttonClass}" type="button" 
                            data-bs-toggle="collapse" data-bs-target="#${collapseId}" 
                            aria-expanded="${ariaExpanded}" aria-controls="${collapseId}">
                            ${category}
                        </button>
                    </h2>
                `;

              let bodyContent = "";
              items.forEach((item) => {
                bodyContent += `
                        <div class="alert alert-primary" role="alert">
                            <p class="mb-2" style="font-weight: 500; color: #333;">
                                ${item.title}
                            </p>
                            
                            <a href="${item.link}" target="_blank" class="btn btn-primary btn-sm">
                                Download
                            </a>
                        </div>
                    `;
              });

              const accordionItem = document.createElement("div");
              accordionItem.className = "accordion-item";
              accordionItem.innerHTML = `
                    ${headerHTML}
                    <div id="${collapseId}" class="${bodyClass}" 
                        aria-labelledby="${headingId}" data-bs-parent="#downloadsAccordion">
                        <div class="accordion-body">
                            ${bodyContent}
                        </div>
                    </div>
                `;

              accordionContainer.appendChild(accordionItem);
              index++;
            }
          } catch (error) {
            console.error("Error:", error);
            document.getElementById("downloadsAccordion").innerHTML =
              '<p class="text-danger text-center">Unable to load downloads.</p>';
          }
        }

        fetchDownloads();
      </script>
      <!-- Google Sheet Integration Ends -->
    </div>

    <!-- Footer Section -->
    <section class="footer">
      <div class="footer-container">
        <div class="social">
          <a
            target="_blank"
            rel="noopener noreferrer"
            href="https://www.facebook.com/share/g/14sbGfnjdY/"
            ><i class="bi bi-facebook"></i
          ></a>
          <a href="mailto:dhepdhepihs@gmail.com"
            ><i class="bi bi-envelope-at-fill"></i
          ></a>
        </div>
        <div class="copyright">
          <p class="copyright-text mt-3 mb-0">© Copyright <span id="year"></span> DDHSS</p>
        </div>
        <div class="love">
          <p>
            Made with ❤ by
            <a
              target="_blank"
              rel="noopener noreferrer"
              href="https://www.facebook.com/jibeshsaha"
              >Jibesh Saha</a
            >
          </p>
        </div>
      </div>
    </section>

    <!-- Footer Javascript -->
     <script>
    // Get the current year automatically
    document.getElementById("year").textContent = new Date().getFullYear();
</script>

    <!-- Bootstrap Javascript -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
